theme(axis.text=element_text(size=15, angle = 90),
axis.title=element_text(size=15))+
theme(legend.text=element_text(size=15), legend.title = element_blank())+
facet_wrap(~colonies, strip.position = "bottom", scales = "free_x")+
theme(panel.spacing = unit(0, "lines"),
#strip.background = element_blank(),
#strip.placement = "outside",
strip.text.x = element_text(size = 15))
comparisonplotinh2
comparisonplotinh2<-ggplot(compdf, aes(x=samples, y=freqspermillion, fill=shared)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_manual(values = c("#999999","Vermillion")) +
ylab("# SNVs per Mbp") + xlab("")+
theme(axis.text=element_text(size=15, angle = 90),
axis.title=element_text(size=15))+
theme(legend.text=element_text(size=15), legend.title = element_blank())+
facet_wrap(~colonies, strip.position = "bottom", scales = "free_x")+
theme(panel.spacing = unit(0, "lines"),
#strip.background = element_blank(),
#strip.placement = "outside",
strip.text.x = element_text(size = 15))
comparisonplotinh2<-ggplot(compdf, aes(x=samples, y=freqspermillion, fill=shared)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_manual(values = c("#999999","Vermillion")) +
ylab("# SNVs per Mbp") + xlab("")+
theme(axis.text=element_text(size=15, angle = 90),
axis.title=element_text(size=15))+
theme(legend.text=element_text(size=15), legend.title = element_blank())+
facet_wrap(~colonies, strip.position = "bottom", scales = "free_x")+
theme(panel.spacing = unit(0, "lines"),
#strip.background = element_blank(),
#strip.placement = "outside",
strip.text.x = element_text(size = 15))
comparisonplotinh2
comparisonplotinh2<-ggplot(compdf, aes(x=samples, y=freqspermillion, fill=shared)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_manual(values = c("#999999","lightgoldenrod1")) +
ylab("# SNVs per Mbp") + xlab("")+
theme(axis.text=element_text(size=15, angle = 90),
axis.title=element_text(size=15))+
theme(legend.text=element_text(size=15), legend.title = element_blank())+
facet_wrap(~colonies, strip.position = "bottom", scales = "free_x")+
theme(panel.spacing = unit(0, "lines"),
#strip.background = element_blank(),
#strip.placement = "outside",
strip.text.x = element_text(size = 15))
comparisonplotinh2
Figure2<-  (comparisonplotinh2 | persampleaveragesplot) /(meandataplot | z2)
Figure2
meandataplot<-ggplot(meandata, aes(x=shared, y=valuemean, fill=shared)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_manual(values = c("#999999", "light blue", "seagreen3")) +
ylab("# SNVs per Mbp per sperm pool") + xlab("")+
geom_errorbar(aes(ymin=valuemean-valuemeanse, ymax=valuemean+valuemeanse))+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15))+
theme(legend.text=element_blank(), legend.title = element_blank()) +
scale_x_discrete(labels=c("Parent and Sperm" = "P+S", "Single Sperm Pool Only" = "SSPO",
"All Sperm Pools" = "ASP"))
meandataplot''
meandataplot
meandataplot<-ggplot(meandata, aes(x=shared, y=valuemean, fill=shared)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_manual(values = c("#999999", "light blue", "seagreen3")) +
ylab("# SNVs per Mbp per sperm pool") + xlab("")+
geom_errorbar(aes(ymin=valuemean-valuemeanse, ymax=valuemean+valuemeanse))+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15))+
theme(legend.position = "none") +
scale_x_discrete(labels=c("Parent and Sperm" = "P+S", "Single Sperm Pool Only" = "SSPO",
"All Sperm Pools" = "ASP"))
meandataplot
Figure2<-  (comparisonplotinh2 | persampleaveragesplot) /(meandataplot | z2)
Figure2
df$shared<-factor(c(rep("All Parent",2),rep("P+S",2),rep("PO",2),rep("SSPO",2),rep("ASP",2)),
levels=c("All Parent","PO","P+S","SSPO","ASP"))
allcolonies<-scatterplot_func(rbind(somaticCA56df,somaticCA60df,somaticCA65df))
CA56_<-scatterplot_func(somaticCA56df)
CA56_CODING<-subset(CA56_, MutationType=="missense_variant" | MutationType=="synonymous_variant"| MutationType=="synonymous_variant")
CA56_inherited<-subset(CA56_, Inheritance=="inherited")
CA56_notinherited<-subset(CA56_, Inheritance=="notinherited")
CA56_loh<-subset(CA56_, GoHorLoH=="LoH")
CA56_denovo<-subset(CA56_, GoHorLoH=="DeNovo")
inheriteddenovoCA56_<-subset(CA56_, GoHorLoH=="DeNovo" & (s1>0 & s2>0))
inheritedlohCA56_<-subset(CA56_, GoHorLoH=="LoH" & SpermAverage==1 & ParentAverage==1)
notinheriteddenovoCA56_<-subset(CA56_, GoHorLoH=="DeNovo" & (s1==0 | s2==0))
notinheritedlohCA56_<-subset(CA56_, GoHorLoH=="LoH" & SpermAverage<1)
inheritedcountCA56_<-nrow(inheriteddenovoCA56_)+nrow(inheritedlohCA56_)
inheritedpropCA56_<- inheritedcountCA56_/nrow(CA56_)
CAP6<-subset(CA56_, sample=="CAP6-1_S47") # when scatterplot_func returns "otherframe"
CAP8<-subset(CA56_, sample=="CAP8-1_S40")
CAP12<-subset(CA56_,sample=="CAP12-1_S46")
CAP6i<-subset(CAP6, Inheritance=="inherited")
CAP8i<-subset(CAP8, Inheritance=="inherited")
CAP6n<-subset(CAP6, Inheritance=="notinherited")
CAP8n<-subset(CAP8, Inheritance=="notinherited")
CA60_<-scatterplot_func(somaticCA60df)
CA60_CODING<-subset(CA60_, MutationType=="missense_variant" | MutationType=="synonymous_variant"| MutationType=="synonymous_variant")
CA60_loh<-subset(CA60_, GoHorLoH=="LoH")
CA60_denovo<-subset(CA60_, GoHorLoH=="DeNovo")
CA60_inherited<-subset(CA60_, Inheritance=="inherited")
CA60_notinherited<-subset(CA60_, Inheritance=="notinherited")
inheriteddenovoCA60_<-subset(CA60_, SpermAverage>0 &ParentAverage>=0.1 &ParentAverage<1)
inheritedlohCA60_<-subset(CA60_, SpermAverage==1 & ParentAverage==1)
notinheriteddenovoCA60_<-subset(CA60_, SpermAverage==0)
notinheritedlohCA60_<-subset(CA60_, ParentAverage==1 & SpermAverage<1)
inheritedcountCA60_<-nrow(inheriteddenovoCA60_)+nrow(inheritedlohCA60_)
CAP22<-subset(CA60_, sample=="CAP22-1_S43")
CAP23<-subset(CA60_, sample=="CAP23-1_S45")
CAP24<-subset(CA60_,sample=="CAP24-1_S42")
CAP26<-subset(CA60_,sample=="CAP26-1_S39")
CAP22i<-subset(CAP22, Inheritance=="inherited")
CAP23i<-subset(CAP23, Inheritance=="inherited")
CAP26i<-subset(CAP26, Inheritance=="inherited")
CAP22n<-subset(CAP22, Inheritance=="notinherited")
CAP23n<-subset(CAP23, Inheritance=="notinherited")
CAP26n<-subset(CAP26, Inheritance=="notinherited")
CA65_<-scatterplot_func(somaticCA65df)
CA65_CODING<-subset(CA65_, MutationType=="missense_variant" | MutationType=="synonymous_variant"| MutationType=="synonymous_variant")
CA65_loh<-subset(CA65_, GoHorLoH=="LoH")
CA65_denovo<-subset(CA65_, GoHorLoH=="DeNovo")
CA65_inherited<-subset(CA65_, Inheritance=="inherited")
CA65_notinherited<-subset(CA65_, Inheritance=="notinherited")
inheriteddenovoCA65_<-subset(CA65_, SpermAverage>0 &ParentAverage>=0.1 &ParentAverage<1)
inheritedlohCA65_<-subset(CA65_, SpermAverage==1 & ParentAverage==1)
notinheriteddenovoCA65_<-subset(CA65_, SpermAverage==0)
notinheritedlohCA65_<-subset(CA65_, ParentAverage==1 & SpermAverage<1)
inheritedcountCA65_<-nrow(inheriteddenovoCA65_)+nrow(inheritedlohCA65_)
CAP10<-subset(CA65_, sample=="CAP10-1_S44")
CAP11<-subset(CA65_, sample=="CAP11-1_S41")
CAP9<-subset(CA65_,sample=="CAP9-1_S48")
CAP11i<-subset(CAP11, Inheritance=="inherited")
CAP9i<-subset(CAP9, Inheritance=="inherited")
CAP11n<-subset(CAP11, Inheritance=="notinherited")
CAP9n<-subset(CAP9, Inheritance=="notinherited")
GOH_func<-function(CAP) {
CAP_GOH<-subset(CAP, Inheritance=="inherited")
return(CAP_GOH)
}
LOH_func<-function(CAP) {
CAP_LOH<-subset(CAP, Inheritance=="inherited")
return(CAP_LOH)
}
CAP11i_GOH<-GOH_func(CAP11i)
CAP11i_LOH<-LOH_func(CAP11i)
totalCA56_<-inheritedcountCA56_+ nrow(uniqueuglmCA56df)+ nrow(gglmCA56df)
totalCA60_<- inheritedcountCA60_+ nrow(uniqueuglmCA60df)+ nrow(gglmCA60df)
totalCA65_<- inheritedcountCA65_+ nrow(uniqueuglmCA65df)+ nrow(gglmCA65df)
CA56i<-c(nrow(subset(CAP6, Inheritance=="inherited")), nrow(subset(CAP8, Inheritance=="inherited")))
#CA56ip<-CA56i/(CA56i+CA56uglm+CA56gglm)
CA60i<-c(nrow(subset(CAP22, Inheritance=="inherited")),nrow(subset(CAP23, Inheritance=="inherited")),nrow(subset(CAP26, Inheritance=="inherited")))
#CA60ip<-CA60i/(CA60i+CA60uglm+CA60gglm)
CA65i<-c(nrow(subset(CAP11, Inheritance=="inherited")),nrow(subset(CAP9, Inheritance=="inherited")))
#CA65ip<-CA65i/(CA65i+CA65uglm+CA65gglm)
CA56n<-c(nrow(subset(CAP6, Inheritance=="notinherited")), nrow(subset(CAP8, Inheritance=="notinherited")))
#CA56np<-CA56n/(CA56n+CA56uglm+CA56gglm)
CA60n<-c(nrow(subset(CAP22, Inheritance=="notinherited")),nrow(subset(CAP23, Inheritance=="notinherited")),nrow(subset(CAP26, Inheritance=="notinherited")))
#CA60np<-CA60n/(CA60n+CA60uglm+CA60gglm)
CA65n<-c(nrow(subset(CAP11, Inheritance=="notinherited")),nrow(subset(CAP9, Inheritance=="notinherited")))
#CA65np<-CA65n/(CA65n+CA65uglm+CA65gglm)
CA56uglm<-c(nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$MutantParent1,'CAP6')==TRUE ) ),
nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$MutantParent1,'CAP8')==TRUE )))
CAS6uglm<-nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$MutantParent1,'CAP6')==TRUE ) )
CAS6uglm<-subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$MutantParent1,'CAP6')==TRUE )
CAS8uglm<-subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$MutantParent1,'CAP8')==TRUE )
#CA56uglmp<-CA56uglm/(CA56i+CA56uglm+CA56gglm)
CA60uglm<-c( nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP22')==TRUE ) ),
nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP23')==TRUE ) ),
nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP26')==TRUE )))#,
#nrow(subset(uniqueuglmCA60, startsWith(uniqueuglmCA60$MutantParent1,'CAP26')==TRUE ))
CAS22uglm<-subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP22')==TRUE )
CAS23uglm<-subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP23')==TRUE )
CAS26uglm<-subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$MutantParent1,'CAP26')==TRUE )
#CA60uglmp<-CA60uglm/(CA60i+CA60uglm+CA60gglm)
CA65uglm<- c(
nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$MutantParent1,'CAP11')==TRUE ) ),
nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$MutantParent1,'CAP9')==TRUE )))
CAS9uglm<-subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$MutantParent1,'CAP9')==TRUE )
CAS11uglm<-subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$MutantParent1,'CAP11')==TRUE )
#CA65uglmp<-CA65uglm/(CA65i+CA65uglm+CA65gglm)
CA56gglm<-c(
nrow(subset(gglmCA56df, startsWith(gglmCA56df$sample,'CAS6')==TRUE ) ),
nrow(subset(gglmCA56df, startsWith(gglmCA56df$sample,'CAS8')==TRUE )))
#CA56gglmp<-CA56gglm/(CA56i+CA56uglm+CA56gglm)
CA60gglm<-c(nrow(subset(gglmCA60df, startsWith(gglmCA60df$sample,'CAS22')==TRUE ) ),
nrow(subset(gglmCA60df, startsWith(gglmCA60df$sample,'CAS23')==TRUE ) ),
nrow(subset(gglmCA60df, startsWith(gglmCA60df$sample,'CAS26')==TRUE )))#,
#nrow(subset(gglmCA60, startsWith(gglmCA60$sample,'CAS26')==TRUE )))
#CA60gglmp<-CA60gglm/(CA60i+CA60uglm+CA60gglm)
CA65gglm<- c(
nrow(subset(gglmCA65df, startsWith(gglmCA65df$sample,'CAS11')==TRUE ) ),
nrow(subset(gglmCA65df, startsWith(gglmCA65df$sample,'CAS9')==TRUE )))
##GOH and LOH proportions
CAP6inh<-nrow(subset(CAP6, Inheritance=="inherited"))
CAP6inhLOH<-nrow(subset(CAP6, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP6inhGOH<-CAP6inh-CAP6inhLOH
CAP6notinh<-nrow(CAP6)-CAP6inh
CAP6notinhLOH<-nrow(subset(CAP6, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP6notinhGOH<-CAP6notinh-CAP6notinhLOH
CAP8inh<-nrow(subset(CAP8, Inheritance=="inherited"))
CAP8inhLOH<-nrow(subset(CAP8, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP8inhGOH<-CAP8inh-CAP8inhLOH
CAP8notinh<-nrow(CAP8)-CAP8inh
CAP8notinhLOH<-nrow(subset(CAP8, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP8notinhGOH<-CAP8notinh-CAP8notinhLOH
CAP22inh<-nrow(subset(CAP22, Inheritance=="inherited"))
CAP22inhLOH<-nrow(subset(CAP22, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP22inhGOH<-CAP22inh-CAP22inhLOH
CAP22notinh<-nrow(CAP22)-CAP22inh
CAP22notinhLOH<-nrow(subset(CAP22, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP22notinhGOH<-CAP22notinh-CAP22notinhLOH
CAP23inh<-nrow(subset(CAP23, Inheritance=="inherited"))
CAP23inhLOH<-nrow(subset(CAP23, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP23inhGOH<-CAP23inh-CAP23inhLOH
CAP23notinh<-nrow(CAP23)-CAP23inh
CAP23notinhLOH<-nrow(subset(CAP23, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP23notinhGOH<-CAP23notinh-CAP23notinhLOH
CAP26inh<-nrow(subset(CAP26, Inheritance=="inherited"))
CAP26inhLOH<-nrow(subset(CAP26, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP26inhGOH<-CAP26inh-CAP26inhLOH
CAP26notinh<-nrow(CAP26)-CAP26inh
CAP26notinhLOH<-nrow(subset(CAP26, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP26notinhGOH<-CAP26notinh-CAP26notinhLOH
CAP9inh<-nrow(subset(CAP9, Inheritance=="inherited"))
CAP9inhLOH<-nrow(subset(CAP9, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP9inhGOH<-CAP9inh-CAP9inhLOH
CAP9notinh<-nrow(CAP9)-CAP9inh
CAP9notinhLOH<-nrow(subset(CAP9, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP9notinhGOH<-CAP9notinh-CAP9notinhLOH
CAP11inh<-nrow(subset(CAP11, Inheritance=="inherited"))
CAP11inhLOH<-nrow(subset(CAP11, Inheritance=="inherited" & GoHorLoH=="LoH"))
CAP11inhGOH<-CAP11inh-CAP11inhLOH
CAP11notinh<-nrow(CAP11)-CAP11inh
CAP11notinhLOH<-nrow(subset(CAP11, Inheritance=="notinherited" & GoHorLoH=="LoH"))
CAP11notinhGOH<-CAP11notinh-CAP11notinhLOH
allGOH<-sum(CAP6inhGOH, CAP6notinhGOH,CAP8inhGOH, CAP8notinhGOH,CAP22inhGOH, CAP22notinhGOH,CAP23inhGOH, CAP23notinhGOH,CAP26inhGOH, CAP26notinhGOH,CAP9inhGOH, CAP9notinhGOH,CAP11inhGOH, CAP11notinhGOH)
allLOH<-sum(CAP6inhLOH, CAP6notinhLOH,CAP8inhLOH, CAP8notinhLOH,CAP22inhLOH, CAP22notinhLOH,CAP23inhLOH, CAP23notinhLOH,CAP26inhLOH, CAP26notinhLOH,CAP9inhLOH, CAP9notinhLOH,CAP11inhLOH, CAP11notinhLOH)
inhGOH<-sum(CAP6inhGOH, CAP8inhGOH, CAP22inhGOH, CAP23inhGOH,CAP26inhGOH, CAP9inhGOH,CAP11inhGOH)
inhLOH<-sum(CAP6inhLOH, CAP8inhLOH, CAP22inhLOH, CAP23inhLOH,CAP26inhLOH, CAP9inhLOH,CAP11inhLOH)
notinhGOH<-sum(CAP6notinhGOH, CAP8notinhGOH, CAP22notinhGOH, CAP23notinhGOH,CAP26notinhGOH, CAP9notinhGOH,CAP11notinhGOH)
notinhLOH<-sum(CAP6notinhLOH, CAP8notinhLOH, CAP22notinhLOH, CAP23notinhLOH,CAP26notinhLOH, CAP9notinhLOH,CAP11notinhLOH)
uglmGOH<-sum(nrow(subset(uniqueuglmCA56df, GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA60df, GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA65df, GoH_or_LoH=="DeNovo")))
uglmLOH<-sum(nrow(subset(uniqueuglmCA56df, GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA60df, GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA65df, GoH_or_LoH=="LoH")))
gglmGOH<-sum(nrow(subset(gglmCA56df, GoH_or_LoH=="DeNovo")), nrow(subset(gglmCA60df, GoH_or_LoH=="DeNovo")), nrow(subset(gglmCA65df, GoH_or_LoH=="DeNovo")))
gglmLOH<-sum(nrow(subset(gglmCA56df, GoH_or_LoH=="LoH")), nrow(subset(gglmCA60df, GoH_or_LoH=="LoH")), nrow(subset(gglmCA65df, GoH_or_LoH=="LoH")))
subset<-c(rep("all",2),rep("inherited",2),rep("not inherited",2))
typez<-rep(c("LoH","GoH"),3)
numbers<-c(allLOH, allGOH, inhLOH,inhGOH,notinhLOH,notinhGOH)
percents<-c(allLOH/(allLOH+allGOH), allGOH/(allLOH+allGOH), inhLOH/(inhLOH+inhGOH),inhGOH/(inhLOH+inhGOH),notinhLOH/(notinhLOH+notinhGOH),notinhGOH/(notinhLOH+notinhGOH))
#sepercents<-c(se(percents)
set<-data.frame(subset,typez,numbers)
z<- ggplot(set, aes(x=subset, y=numbers,fill=typez)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
scale_fill_brewer(palette = "Paired") +
ylab("Number of mutations") + xlab("")+
theme(axis.text=element_text(size=25),
axis.title=element_text(size=25))   +
theme(legend.text=element_text(size=25))
GOHallsom<- c((CAP6inhGOH+ CAP6notinhGOH)/nrow(CAP6), (CAP8inhGOH+ CAP8notinhGOH)/nrow(CAP8), (CAP22inhGOH+ CAP22notinhGOH)/nrow(CAP22), (CAP23inhGOH+ CAP23notinhGOH)/nrow(CAP23), (CAP26inhGOH+ CAP26notinhGOH)/nrow(CAP26), (CAP9inhGOH+ CAP9notinhGOH)/nrow(CAP9), (CAP11inhGOH+ CAP11notinhGOH)/nrow(CAP11))
meanGOHallsom<- mean(GOHallsom)
seGOHallsom<-se( GOHallsom)
LOHallsom<-c((CAP6inhLOH+ CAP6notinhLOH)/nrow(CAP6), (CAP8inhLOH+ CAP8notinhLOH)/nrow(CAP8), (CAP22inhLOH+ CAP22notinhLOH)/nrow(CAP22), (CAP23inhLOH+ CAP23notinhLOH)/nrow(CAP23), (CAP26inhLOH+ CAP26notinhLOH)/nrow(CAP26), (CAP9inhLOH+ CAP9notinhLOH)/nrow(CAP9), (CAP11inhLOH+ CAP11notinhLOH)/nrow(CAP11))
meanLOHallsom<-mean(LOHallsom)
seLOHallsom<-se( LOHallsom)
GOHinh<-c				  (CAP6inhGOH/CAP6inh, (CAP8inhGOH)/CAP8inh, (CAP22inhGOH)/CAP22inh, (CAP23inhGOH)/CAP23inh,
(CAP26inhGOH)/CAP26inh, (CAP9inhGOH)/CAP9inh, (CAP11inhGOH)/CAP11inh)
meanGOHinh<-mean(GOHinh)
seGOHinh<-se(GOHinh)
LOHinh<- c(CAP6inhLOH/CAP6inh, (CAP8inhLOH)/CAP8inh, (CAP22inhLOH)/CAP22inh, (CAP23inhLOH)/CAP23inh,
(CAP26inhLOH)/CAP26inh, (CAP9inhLOH)/CAP9inh, (CAP11inhLOH)/CAP11inh)
meanLOHinh<-mean(LOHinh)
GOHnotinh<-c				  (CAP6notinhGOH/CAP6notinh, (CAP8notinhGOH)/CAP8notinh, (CAP22notinhGOH)/CAP22notinh, (CAP23notinhGOH)/CAP23notinh,
(CAP26notinhGOH)/CAP26notinh, (CAP9notinhGOH)/CAP9notinh, (CAP11notinhGOH)/CAP11notinh)
LOHnotinh<-c				  (CAP6notinhLOH/CAP6notinh, (CAP8notinhLOH)/CAP8notinh, (CAP22notinhLOH)/CAP22notinh, (CAP23notinhLOH)/CAP23notinh,
(CAP26notinhLOH)/CAP26notinh, (CAP9notinhLOH)/CAP9notinh, (CAP11notinhLOH)/CAP11notinh)
GOHuglm<-c(nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$sample,'CAP6')==TRUE & GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$sample,'CAP8')==TRUE & GoH_or_LoH=="DeNovo")),
nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAP22')==TRUE & GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAP23')==TRUE & GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAP26')==TRUE & GoH_or_LoH=="DeNovo")),
nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$sample,'CAP9')==TRUE & GoH_or_LoH=="DeNovo")), nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$sample,'CAP11')==TRUE & GoH_or_LoH=="DeNovo")))
LOHuglm<-c(nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$sample,'CAS6')==TRUE & GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA56df, startsWith(uniqueuglmCA56df$sample,'CAS8')==TRUE & GoH_or_LoH=="LoH")),
nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAS22')==TRUE & GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAS23')==TRUE & GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA60df, startsWith(uniqueuglmCA60df$sample,'CAS26')==TRUE & GoH_or_LoH=="LoH")),
nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$sample,'CAS9')==TRUE & GoH_or_LoH=="LoH")), nrow(subset(uniqueuglmCA65df, startsWith(uniqueuglmCA65df$sample,'CAS11')==TRUE & GoH_or_LoH=="LoH")))
uglmsums<-GOHuglm + LOHuglm
GOHuglmprop<- GOHuglm/ uglmsums
LOHuglmprop<- LOHuglm/ uglmsums
meanGOHuglmprop<- mean(GOHuglmprop)
meanLOHuglmprop<- mean(LOHuglmprop)
GOHgglm<-c( nrow(subset(gglmCA56df, GoH_or_LoH=="DeNovo")), nrow(subset(gglmCA60df, GoH_or_LoH=="DeNovo")), nrow(subset(gglmCA65df, GoH_or_LoH=="DeNovo")))
LOHgglm<-c( nrow(subset(gglmCA56df, GoH_or_LoH=="LoH")), nrow(subset(gglmCA60df, GoH_or_LoH=="LoH")), nrow(subset(gglmCA65df, GoH_or_LoH=="LoH")))
gglmsums<- GOHgglm + LOHgglm
GOHgglmprop<- GOHgglm/ gglmsums
GOHgglmprop<-na.omit(GOHgglmprop)
LOHgglmprop<- LOHgglm/ gglmsums
LOHgglmprop<-na.omit(LOHgglmprop)
meanGOHgglmprop<- mean(GOHgglmprop)
meanLOHgglmprop<- mean(LOHgglmprop)
subsetz<-factor(c(rep("all somatic",2), rep("inherited",2),rep("not inherited",2), rep("uglm",2), rep("gglm",2)),level=c("all somatic","inherited","not inherited","uglm","gglm"))
means<-c(meanGOHallsom, meanLOHallsom, meanGOHinh, meanLOHinh, mean(GOHnotinh), mean(LOHnotinh), meanGOHuglmprop, meanLOHuglmprop, meanGOHgglmprop, meanLOHgglmprop)
allse<-c(seGOHallsom, seLOHallsom, seGOHinh, se(LOHinh),se(GOHnotinh), se(LOHnotinh), se(GOHuglmprop), se(LOHuglmprop), se(GOHgglmprop), se(LOHgglmprop))
typez2<-rep(c("GoH","LoH"),5)
#human sperm from Wang et al. 2012 Cell:
GOHcounts<-c(36,
30,
35,
33,
27,
34,
25,
31)
LOHcounts<-c(10,
12,
10,
13,
6,
10,
16,
13)
GOHprop<-GOHcounts/(GOHcounts+LOHcounts)
LOHprop<-1-GOHprop
meanGOHprop<-mean(GOHprop)
meanLOHprop<-mean(LOHprop)
seGOH<-se(GOHprop)
seLOH<-se(LOHprop)
df<-data.frame(subsetz, typez2, means, allse )
df$meanspercent<-100*df$means
df$allsepercent<-100*allse
df$shared<-factor(c(rep("All Parent",2),rep("P+S",2),rep("PO",2),rep("SSPO",2),rep("ASP",2)),
levels=c("All Parent","PO","P+S","SSPO","ASP"))
df_withoutallsom<-df[-(1:2),]
df
df_withoutallsom
z2<- ggplot(df_withoutallsom, aes(x=shared, y=meanspercent,fill=typez2)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
#scale_fill_brewer(palette = "Paired") +
ylab("Percent of SNVs") + xlab("")+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15))   +
theme(legend.text=element_text(size=15),
axis.text.x = element_text(angle = 90),
legend.title=element_blank())+
geom_errorbar(position="dodge",aes(ymin=meanspercent-(allsepercent), ymax=meanspercent+(allsepercent)))
z2
Figure2<-  (comparisonplotinh2 | persampleaveragesplot) /(meandataplot | z2)
Figure2
persampleaverages
fullgenomerates<- c(CA56n_GOH/CA56denom, CA60n_GOH/CA60denom,CA65n_GOH/CA65denom,
CA56i_GOH/CA56denom, CA60i_GOH/CA60denom,CA65i_GOH/CA65denom,
CA56uglm_GOH/CA56denom, CA60uglm_GOH/CA60denom,CA65uglm_GOH/CA65denom,
CA56n_LOH/CA56denom, CA60n_LOH/CA60denom,CA65n_LOH/CA65denom,
CA56i_LOH/CA56denom, CA60i_LOH/CA60denom,CA65i_LOH/CA65denom,
CA56uglm_LOH/CA56denom, CA60uglm_LOH/CA60denom,CA65uglm_LOH/CA65denom)
fullgenomerates
length(fullgenomerates)
fullgenomerates<- c(CA56n_GOH/CA56denom, CA60n_GOH/CA60denom,CA65n_GOH/CA65denom,
CA56i_GOH/CA56denom, CA60i_GOH/CA60denom,CA65i_GOH/CA65denom,
CA56uglm_GOH/CA56denom, CA60uglm_GOH/CA60denom,CA65uglm_GOH/CA65denom,
CA56n_LOH/CA56denom, CA60n_LOH/CA60denom,CA65n_LOH/CA65denom,
CA56i_LOH/CA56denom, CA60i_LOH/CA60denom,CA65i_LOH/CA65denom,
CA56uglm_LOH/CA56denom, CA60uglm_LOH/CA60denom,CA65uglm_LOH/CA65denom)
codingrates<-c(CA56n_coding_GOH/CA56denom_coding, CA60n_coding_GOH/CA60denom_coding,CA65n_coding_GOH/CA65denom_coding,
CA56i_coding_GOH/CA56denom_coding, CA60i_coding_GOH/CA60denom_coding,CA65i_coding_GOH/CA65denom_coding,
CA56uglm_coding_GOH/CA56denom_coding, CA60uglm_coding_GOH/CA60denom_coding,CA65uglm_coding_GOH/CA65denom_coding,
CA56n_coding_LOH/CA56denom_coding, CA60n_coding_LOH/CA60denom_coding,CA65n_coding_LOH/CA65denom_coding,
CA56i_coding_LOH/CA56denom_coding, CA60i_coding_LOH/CA60denom_coding,CA65i_coding_LOH/CA65denom_coding,
CA56uglm_coding_LOH/CA56denom_coding, CA60uglm_coding_LOH/CA60denom_coding,CA65uglm_coding_LOH/CA65denom_coding)
persamplerates_coding<-fullgenomerates/codingrates
rateratios<-fullgenomerates/codingrates
rateratios
mean(rateratios[1:7])
rateratios<-meanpercolony$mean[1:6]/meanpercolony$mean[7:12]
rateratis
rateratios
fr
ratiosplot
ratios_frame
rateratios
nrow(everything)
nrow(gglmCA56df)
nrow(gglmCA56df)+nrow(gglmCA60df)+nrow(gglmCA65df)
##how to get avg depths from unix: grep -A1 'mean' *sample_summary | grep -v 'mean' | awk '{print $3}'
CAPavgdepths<-c(14.25,
17.12,
19.7,
32.95,
34.68,
33.25,
24.01,
39.49,
40.51,
40.75,
45.38,
30.9,
34.22,
41.19,
49.18,
23.1,
45.88,
23.95)
CASavgdepths<-c(44.07,
80.68,
54.97,
42.03,
54.93,
18.79,
54.41,
20.09,
33.91,
56.57,
59.49,
59.38,
55.23,
93.85)
mean(CAPavgdepths)
se(CAPavgdepths)
mean(CASavgdepths)
se(CASavgdepths)
compdf
n_percent<-nfreqs*100/(nfreqs+ifreqs)
n_percent
i_percent<-ifreqs*100/(nfreqs+ifreqs)
i_percent
i_percent + n_percent
mean(n_percent)
mean(i_percent)
n_perc<-c(CAP6n/(CAP6), CAP8n/CAP8, CAP22n/CAP22, CAP23n/CAP23, CAP24/CAP24n, CAP9n/CAP9, CAP11n/CAP11)
n_perc<-c(CAP6n/(CAP6i+CAP6n), CAP8n/(CAP8i+CAP8n), CAP22n/(CAP22i+CAP22n), CAP23n/(CAP23i+CAP23n),
CAP24n/(CAP24i+CAP24n), CAP9n/(CAP9i+CAP9n), CAP11n/(CAP11i+CAP11n))
CAP6i
#CA65np<-CA65n/(CA65n+CA65uglm+CA65gglm)
CAPn<-c(CA56n, CA60n, CA65n)
CAPi<-c(CA56i, CA60i, CA65i)
CAPn
CAPi
n_perc<-(100*CAPn)/(CAPn+CAPi)
n_perc
i_perc<-(100*CAPi)/(CAPn+CAPi)
mean(n_perc)
mean(n_percent)
se(n_percent)
mean(i_perc)
mean(i_percent)
se(i_perc)
?t.test()
t.test(n_percent, i_percent)
var()
var(n_percent)
?var()
var(i_percent)
var(nfreqspermillion)
mean(nfreqspermillion)
n_percent
t.test(n_percent, i_percent)
t.test(n_percent, i_percent,alternative=c("greater"))
t.test(n_percent, i_percent,alternative=c("less"))
t.test(n_percent, i_percent,alternative=c("greater"))
t.test(n_percent, i_percent,alternative=c("greater",paired=FALSE))
t.test(n_percent, i_percent,alternative=c("greater"),paired=FALSE)
t.test(n_percent, i_percent,alternative=c("two.sided"),paired=FALSE)
n_percent
var(n_percent[1:2])
var(n_percent[3:5])
var(n_percent[6:7])
mean(n_percent[1:2])
mean(n_percent[3:5])
mean(n_percent[6:7])
mean(i_percent[1:2])
mean(i_percent[3:5])
mean(i_percent[6:7])
meanpercolony
persampleaverages
n_GOH<-c(CA56n_GOH/CA56denom, CA60n_GOH/CA60denom,CA65n_GOH/CA65denom)
n_GOH_coding<-c(CA56n_coding_GOH/CA56denom_coding, CA60n_coding_GOH/CA60denom_coding,CA65n_coding_GOH/CA65denom_coding)
n_GOH
n_GOH_coding
t.test(n_GOH, n_GOH_coding)
var(n_GOH)
var(n_GOH_coding)
plot(var(n_GOH))
t.test(n_GOH, n_GOH_coding, alternative=c("two.sided"),paired=FALSE)
i_GOH<-c(CA56i_GOH/CA56denom, CA60i_GOH/CA60denom,CA65i_GOH/CA65denom)
i_GOH_coding<-c(CA56i_coding_GOH/CA56denom_coding, CA60i_coding_GOH/CA60denom_coding,CA65i_coding_GOH/CA65denom_coding)
uglm_GOH<-c(CA56uglm_GOH/CA56denom, CA60uglm_GOH/CA60denom,CA65uglm_GOH/CA65denom)
uglm_GOH_coding<-c(CA56uglm_coding_GOH/CA56denom_coding, CA60uglm_coding_GOH/CA60denom_coding,CA65uglm_coding_GOH/CA65denom_coding)
n_LOH<-c(CA56n_LOH/CA56denom, CA60n_LOH/CA60denom,CA65n_LOH/CA65denom)
n_LOH_coding<-c(CA56n_coding_LOH/CA56denom_coding, CA60n_coding_LOH/CA60denom_coding,CA65n_coding_LOH/CA65denom_coding)
i_LOH<-c(CA56i_LOH/CA56denom, CA60i_LOH/CA60denom,CA65i_LOH/CA65denom)
i_LOH_coding<-c(CA56i_coding_LOH/CA56denom_coding, CA60i_coding_LOH/CA60denom_coding,CA65i_coding_LOH/CA65denom_coding)
uglm_LOH<-c(CA56uglm_LOH/CA56denom, CA60uglm_LOH/CA60denom,CA65uglm_LOH/CA65denom)
uglm_LOH_coding<-c(CA56uglm_coding_LOH/CA56denom_coding, CA60uglm_coding_LOH/CA60denom_coding,CA65uglm_coding_LOH/CA65denom_coding)
var(n_GOH, i_GOH, uglm_GOH, n_LOH, i_LOH, uglm_LOH)
vars<-c(var(n_GOH), var(i_GOH), var(uglm_GOH), var(n_LOH), var(i_LOH), var(uglm_LOH))
vars_coding<-c(var(n_GOH_coding), var(i_GOH_coding), var(uglm_GOH_coding), var(n_LOH_coding), var(i_LOH_coding), var(uglm_LOH_coding))
vars/vars_coding
vars
vars_coding
t.test(n_GOH, n_GOH_coding, alternative=c("two.sided"),paired=TRUE)
t.test(i_GOH, i_GOH_coding, alternative=c("two.sided"),paired=TRUE)
t.test(uglm_GOH, uglm_GOH_coding, alternative=c("two.sided"),paired=TRUE)
t.test(n_LOH, n_LOH_coding, alternative=c("two.sided"),paired=TRUE)
t.test(i_LOH, i_LOH_coding, alternative=c("two.sided"),paired=TRUE)
t.test(uglm_LOH, uglm_LOH_coding, alternative=c("two.sided"),paired=TRUE)
persampleaveragesplot
t.test((uglm_LOH*1000000), (uglm_LOH_coding*1000000), alternative=c("two.sided"),paired=TRUE)
t.test(n_GOH*1000000, n_GOH_coding*1000000, alternative=c("two.sided"),paired=TRUE)
mean(n_GOH*1000000)
meanpercolony
