building snpeff database:
1. edit .config file
2. cd ~/snpEff/data
unzip Amil_v2.01
cd Amil_v2.01
cp Amil.coding.gff3  genes.gff
cp Amil.all.maker.proteins.fasta protein.fa
cp Amil.v2.01.chrs.fasta sequences.fa

3. ml load java
java -jar snpEff.jar build -gff3 -v Amil_v2.01
4. java -Xmx64g -jar /scratch/users/elora/snpEff/snpEff.jar -v -c /scratch/users/elora/snpEff/snpEff.config Amil_v2.01 CAcolony56.vcf_genotyped.vcf_filtered_nomissing.vcf > CAcolony56.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf


Germline Pipeline:
1. hisat2AHB152-2.sh up to 8 hrs
2. dedupetc.sh
3. pbhapotypecallerGVCF_GPUpartition.sh (parabricks) or haplotypecaller_GVCFnotBP.sh (nonparabricks)
4. combineGVCFsAHB152.sh
5a. genotypeGVCFsAHB154.sh #gives just the variant sites
5b. genotypeGVCFsallsites.sh #gives all sites
6. use filterVCF.sh on the outputfile from 5a
7. inheritanceinvestigator.py
8. melt
9.definemutationtypes.py
10. downstream analyses.r : output write.table(uniquemetadatadf, file="CAcolony60CAP22uniquemuts.txt",sep="\t",quote=FALSE, row.name=FALSE)



snpeff:
AnnotateVCF.sh on the full colony filtered VCFs
ie:
	
	
Then, MatchVerifiedMutswithAnnotatedVCF.py to match the muts_relabeled with the annotated VCF

ie:
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony56CAP12muts_relabeled56.txt ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony56.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony56CAP12muts_relabeled56.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony56CAP6muts_relabeled56.txt ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony56.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony56CAP6muts_relabeled56.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony56CAP8muts_relabeled56.txt ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony56.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony56CAP8muts_relabeled56.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony60_CAP22muts_relabeled60.txt  ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony60.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony60_CAP22muts_relabeled60.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony60_CAP23muts_relabeled60.txt  ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony60.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony60_CAP23muts_relabeled60.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony60_CAP24muts_relabeled60.txt  ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony60.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony60_CAP24muts_relabeled60.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony65_CAP11muts_relabeled65.txt ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony65.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > CAcolony65_CAP11muts_relabeled65.txt.ann.txt
	python3 MatchVerifiedMutswithAnnotatedVCF.py CAcolony65_CAP9muts_relabeled65.txt ../../BikiniSequencing/NovaSeqS4_20191022/CAcolony65.vcf_genotyped.vcf_filtered_nomissing.vcf.ann.vcf > Acolony65_CAP9muts_relabeled65.txt.ann.txt

